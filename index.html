<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quality Care Upholstery - Quote Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .input-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }

        .quote-preview {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 20px;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.8em;
        }

        h2 {
            color: #444;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
        }

        textarea {
            height: 80px;
            resize: vertical;
        }

        .btn {
            background: #007bff;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #0056b3;
        }

        .btn-success {
            background: #28a745;
        }

        .btn-success:hover {
            background: #1e7e34;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        /* Quote Template Styles */
        .quote-template {
            padding: 25px;
            background: white;
            font-family: Arial, sans-serif;
            color: #333;
            line-height: 1.3;
            height: 11in;
            width: 8.5in;
            margin: 0 auto;
            box-sizing: border-box;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .quote-header {
            display: grid;
            grid-template-columns: 1fr auto;
            margin-bottom: 20px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 15px;
        }

        .company-info h1 {
            color: #007bff;
            font-size: 1.8em;
            margin-bottom: 5px;
            text-align: left;
        }

        .company-info p {
            margin: 2px 0;
            color: #666;
            font-size: 13px;
        }

        .quote-number {
            text-align: right;
            color: #666;
        }

        .quote-number h2 {
            font-size: 1.3em;
            margin-bottom: 5px;
        }

        .quote-number p {
            font-size: 13px;
            margin: 2px 0;
        }

        .quote-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .customer-info, .quote-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
        }

        .customer-info h3, .quote-info h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .customer-info p, .quote-info p {
            font-size: 13px;
            margin: 2px 0;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .items-table th {
            background: #007bff;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            font-size: 12px;
        }

        .items-table td {
            padding: 6px 8px;
            border-bottom: 1px solid #ddd;
            font-size: 11px;
        }

        .items-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .quote-total {
            text-align: right;
            margin-top: 15px;
            flex-shrink: 0;
        }

        .total-row {
            display: grid;
            grid-template-columns: 1fr auto;
            padding: 3px 0;
            max-width: 250px;
            margin-left: auto;
            font-size: 13px;
        }

        .total-row.final {
            border-top: 2px solid #333;
            font-weight: bold;
            font-size: 1.1em;
            color: #007bff;
            margin-top: 8px;
            padding-top: 8px;
        }

        .quote-footer {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .signature-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 20px;
            padding-top: 20px;
        }

        .signature-box {
            text-align: center;
        }

        .signature-line {
            border-bottom: 1px solid #333;
            height: 40px;
            margin-bottom: 5px;
        }

        .signature-label {
            font-size: 12px;
            color: #666;
        }

        .terms {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .terms h4 {
            margin-bottom: 8px;
            color: #333;
            font-size: 13px;
        }

        .terms ul {
            margin-left: 15px;
        }

        .terms li {
            margin-bottom: 3px;
            font-size: 11px;
            line-height: 1.2;
        }

        .item-row {
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .remove-item {
            float: right;
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .actions {
            text-align: center;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .quote-details {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        @media print {
            body {
                background: white;
            }
            
            .input-section, .actions {
                display: none;
            }
            
            .quote-preview {
                box-shadow: none;
                margin: 0;
            }
            
            .container {
                grid-template-columns: 1fr;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="input-section">
            <h1>Quote Generator</h1>
            
            <h2>Company Information</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="companyName">Company Name</label>
                    <input type="text" id="companyName" value="Quality Care Upholstery">
                </div>
                <div class="form-group">
                    <label for="quoteNumber">Quote Number</label>
                    <input type="text" id="quoteNumber" value="QCU-000012">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="companyPhone">Phone</label>
                    <input type="text" id="companyPhone" value="214-223-3267">
                </div>
                <div class="form-group">
                    <label for="companyEmail">Email</label>
                    <input type="email" id="companyEmail" value="maxr1118@gmail.com">
                </div>
            </div>
            
            <div class="form-group">
                <label for="companyAddress">Address</label>
                <textarea id="companyAddress">3509 Camden Drive&#10;Melissa, TX 75454</textarea>
            </div>

            <h2>Customer Information</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="customerName">Customer Name</label>
                    <input type="text" id="customerName" required>
                </div>
                <div class="form-group">
                    <label for="customerPhone">Phone</label>
                    <input type="text" id="customerPhone">
                </div>
            </div>
            
            <div class="form-group">
                <label for="customerEmail">Email</label>
                <input type="email" id="customerEmail">
            </div>
            
            <div class="form-group">
                <label for="customerAddress">Address</label>
                <textarea id="customerAddress"></textarea>
            </div>

            <h2>Quote Details</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="quoteDate">Quote Date</label>
                    <input type="date" id="quoteDate">
                </div>
                <div class="form-group">
                    <label for="validUntil">Valid Until</label>
                    <input type="date" id="validUntil">
                </div>
            </div>

            <h2>Line Items</h2>
            <div id="itemsContainer">
                <!-- Items will be added here -->
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="itemDescription">Description</label>
                    <input type="text" id="itemDescription" placeholder="Chair reupholstery">
                </div>
                <div class="form-group">
                    <label for="itemQuantity">Quantity</label>
                    <input type="number" id="itemQuantity" value="1" min="1">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="itemPrice">Unit Price ($)</label>
                    <input type="number" id="itemPrice" step="0.01" min="0">
                </div>
                <div class="form-group">
                    <button type="button" class="btn" onclick="addItem()" style="margin-top: 25px;">Add Item</button>
                </div>
            </div>

            <h2>Additional Costs</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="taxRate">Tax Rate (%)</label>
                    <input type="number" id="taxRate" step="0.01" min="0" value="8.25">
                </div>
                <div class="form-group">
                    <label for="discountAmount">Discount ($)</label>
                    <input type="number" id="discountAmount" step="0.01" min="0" value="0">
                </div>
            </div>

            <h2>Notes & Terms</h2>
            <div class="form-group">
                <label for="notes">Notes</label>
                <textarea id="notes" placeholder="Additional project details, special requirements, etc."></textarea>
            </div>

            <div class="actions">
                <button type="button" class="btn btn-success" onclick="generatePDF()">Export to PDF</button>
                <button type="button" class="btn btn-secondary" onclick="printQuote()">Print Quote</button>
                <button type="button" class="btn btn-danger" onclick="clearForm()">Clear All</button>
            </div>
        </div>

        <div class="quote-preview">
            <div class="quote-template" id="quoteTemplate">
                <div class="quote-header">
                    <div class="company-info">
                        <h1 id="previewCompanyName">Quality Care Upholstery</h1>
                        <p id="previewCompanyPhone">214-223-3267</p>
                        <p id="previewCompanyEmail">maxr1118@gmail.com</p>
                        <p id="previewCompanyAddress">3509 Camden Drive<br>Melissa, TX 75454</p>
                    </div>
                    <div class="quote-number">
                        <h2>QUOTE</h2>
                        <p>Quote #: <span id="previewQuoteNumber">-</span></p>
                        <p>Date: <span id="previewQuoteDate">-</span></p>
                        <p>Valid Until: <span id="previewValidUntil">-</span></p>
                    </div>
                </div>

                <div class="quote-details">
                    <div class="customer-info">
                        <h3>Bill To:</h3>
                        <p id="previewCustomerName">-</p>
                        <p id="previewCustomerPhone">-</p>
                        <p id="previewCustomerEmail">-</p>
                        <p id="previewCustomerAddress">-</p>
                    </div>
                    <div class="quote-info">
                        <h3>Quote Summary:</h3>
                        <p><strong>Items:</strong> <span id="previewItemCount">0</span></p>
                        <p><strong>Subtotal:</strong> $<span id="previewSubtotal">0.00</span></p>
                        <p><strong>Tax:</strong> $<span id="previewTax">0.00</span></p>
                        <p><strong>Total:</strong> $<span id="previewTotal">0.00</span></p>
                    </div>
                </div>

                <table class="items-table">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th style="width: 80px;">Qty</th>
                            <th style="width: 100px;">Unit Price</th>
                            <th style="width: 100px;">Total</th>
                        </tr>
                    </thead>
                    <tbody id="previewItemsTable">
                        <!-- Items will be populated here -->
                    </tbody>
                </table>

                <div class="quote-total">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span>$<span id="previewSubtotal2">0.00</span></span>
                    </div>
                    <div class="total-row" id="discountRow" style="display: none;">
                        <span>Discount:</span>
                        <span>-$<span id="previewDiscount">0.00</span></span>
                    </div>
                    <div class="total-row">
                        <span>Tax (<span id="previewTaxRate">8.25</span>%):</span>
                        <span>$<span id="previewTax2">0.00</span></span>
                    </div>
                    <div class="total-row final">
                        <span>TOTAL:</span>
                        <span>$<span id="previewTotal2">0.00</span></span>
                    </div>
                </div>

                <div class="quote-footer">
                    <div>
                        <div id="previewNotes"></div>
                        
                        <div class="terms">
                            <h4>Terms & Conditions:</h4>
                            <ul>
                                <li>This quote is valid for 30 days from the date above</li>
                                <li>50% deposit required to begin work</li>
                                <li>Final payment due upon completion</li>
                                <li>Customer-provided materials must be delivered before work begins</li>
                                <li>Prices subject to change based on material costs</li>
                                <li>Additional charges may apply for structural repairs</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="signature-section">
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <div class="signature-label">Customer Signature</div>
                        </div>
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <div class="signature-label">Date</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let items = [];
        let itemIdCounter = 0;

        // Initialize with current date
        document.getElementById('quoteDate').value = new Date().toISOString().split('T')[0];
        
        // Set valid until to 30 days from now
        const validDate = new Date();
        validDate.setDate(validDate.getDate() + 30);
        document.getElementById('validUntil').value = validDate.toISOString().split('T')[0];

        // Generate quote number
        document.getElementById('quoteNumber').value = 'QCU-000012';

        // Add event listeners for real-time updates
        const inputs = document.querySelectorAll('input, textarea, select');
        inputs.forEach(input => {
            input.addEventListener('input', updatePreview);
        });

        function addItem() {
            const description = document.getElementById('itemDescription').value.trim();
            const quantity = parseInt(document.getElementById('itemQuantity').value) || 1;
            const price = parseFloat(document.getElementById('itemPrice').value) || 0;

            if (!description) {
                alert('Please enter a description');
                return;
            }

            const item = {
                id: ++itemIdCounter,
                description,
                quantity,
                price,
                total: quantity * price
            };

            items.push(item);
            
            // Clear inputs
            document.getElementById('itemDescription').value = '';
            document.getElementById('itemQuantity').value = '1';
            document.getElementById('itemPrice').value = '';

            updateItemsDisplay();
            updatePreview();
        }

        function removeItem(id) {
            items = items.filter(item => item.id !== id);
            updateItemsDisplay();
            updatePreview();
        }

        function updateItemsDisplay() {
            const container = document.getElementById('itemsContainer');
            container.innerHTML = '';

            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'item-row';
                div.innerHTML = `
                    <button class="remove-item" onclick="removeItem(${item.id})">×</button>
                    <strong>${item.description}</strong><br>
                    Qty: ${item.quantity} × $${item.price.toFixed(2)} = $${item.total.toFixed(2)}
                `;
                container.appendChild(div);
            });
        }

        function updatePreview() {
            // Update company info
            document.getElementById('previewCompanyName').textContent = 
                document.getElementById('companyName').value || 'Quality Care Upholstery';
            document.getElementById('previewCompanyPhone').textContent = 
                document.getElementById('companyPhone').value || '';
            document.getElementById('previewCompanyEmail').textContent = 
                document.getElementById('companyEmail').value || '';
            document.getElementById('previewCompanyAddress').innerHTML = 
                (document.getElementById('companyAddress').value || '').replace(/\n/g, '<br>');

            // Update quote info
            document.getElementById('previewQuoteNumber').textContent = 
                document.getElementById('quoteNumber').value || '-';
            document.getElementById('previewQuoteDate').textContent = 
                formatDate(document.getElementById('quoteDate').value);
            document.getElementById('previewValidUntil').textContent = 
                formatDate(document.getElementById('validUntil').value);

            // Update customer info
            document.getElementById('previewCustomerName').textContent = 
                document.getElementById('customerName').value || '-';
            document.getElementById('previewCustomerPhone').textContent = 
                document.getElementById('customerPhone').value || '';
            document.getElementById('previewCustomerEmail').textContent = 
                document.getElementById('customerEmail').value || '';
            document.getElementById('previewCustomerAddress').innerHTML = 
                (document.getElementById('customerAddress').value || '-').replace(/\n/g, '<br>');

            // Update items table
            const tbody = document.getElementById('previewItemsTable');
            tbody.innerHTML = '';
            
            items.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.description}</td>
                    <td>${item.quantity}</td>
                    <td>$${item.price.toFixed(2)}</td>
                    <td>$${item.total.toFixed(2)}</td>
                `;
                tbody.appendChild(row);
            });

            // Calculate totals
            const subtotal = items.reduce((sum, item) => sum + item.total, 0);
            const discount = parseFloat(document.getElementById('discountAmount').value) || 0;
            const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
            const discountedSubtotal = subtotal - discount;
            const tax = (discountedSubtotal * taxRate) / 100;
            const total = discountedSubtotal + tax;

            // Update preview totals
            document.getElementById('previewItemCount').textContent = items.length;
            document.getElementById('previewSubtotal').textContent = subtotal.toFixed(2);
            document.getElementById('previewSubtotal2').textContent = subtotal.toFixed(2);
            document.getElementById('previewTax').textContent = tax.toFixed(2);
            document.getElementById('previewTax2').textContent = tax.toFixed(2);
            document.getElementById('previewTaxRate').textContent = taxRate.toFixed(2);
            document.getElementById('previewTotal').textContent = total.toFixed(2);
            document.getElementById('previewTotal2').textContent = total.toFixed(2);

            // Show/hide discount row
            if (discount > 0) {
                document.getElementById('discountRow').style.display = 'grid';
                document.getElementById('previewDiscount').textContent = discount.toFixed(2);
            } else {
                document.getElementById('discountRow').style.display = 'none';
            }

            // Update notes
            const notes = document.getElementById('notes').value;
            const notesDiv = document.getElementById('previewNotes');
            if (notes.trim()) {
                notesDiv.innerHTML = `<h4>Notes:</h4><p>${notes.replace(/\n/g, '<br>')}</p>`;
            } else {
                notesDiv.innerHTML = '';
            }
        }

        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        function generatePDF() {
            const element = document.getElementById('quoteTemplate');
            const customerName = document.getElementById('customerName').value || 'Customer';
            const quoteNumber = document.getElementById('quoteNumber').value || 'Quote';
            
            html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
                
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                pdf.save(`${quoteNumber}_${customerName.replace(/\s+/g, '_')}.pdf`);
            });
        }

        function printQuote() {
            window.print();
        }

        function clearForm() {
            if (confirm('Are you sure you want to clear all data?')) {
                document.querySelectorAll('input:not(#companyName):not(#companyPhone):not(#companyEmail), textarea:not(#companyAddress)').forEach(input => {
                    input.value = '';
                });
                document.getElementById('taxRate').value = '8.25';
                document.getElementById('discountAmount').value = '0';
                items = [];
                itemIdCounter = 0;
                
                // Reset dates and quote number
                document.getElementById('quoteDate').value = new Date().toISOString().split('T')[0];
                const validDate = new Date();
                validDate.setDate(validDate.getDate() + 30);
                document.getElementById('validUntil').value = validDate.toISOString().split('T')[0];
                document.getElementById('quoteNumber').value = 'QCU-' + Date.now().toString().slice(-6);
                
                updateItemsDisplay();
                updatePreview();
            }
        }

        // Initial preview update
        updatePreview();
    </script>
</body>
</html>